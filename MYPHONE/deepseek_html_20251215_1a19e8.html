<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“ Ø¯Ù„ÙŠÙ„ Ù‡Ø§ØªÙÙŠ - Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</title>
    
    <!-- Font Awesome Ù„Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts Ù„Ù„Ø®Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #2196F3;
            --primary-dark: #1976D2;
            --secondary-color: #4CAF50;
            --accent-color: #FF9800;
            --danger-color: #F44336;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --text-color: #333;
            --text-light: #666;
            --border-color: #dee2e6;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --radius: 8px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
        .header {
            background: linear-gradient(90deg, var(--primary-dark), var(--primary-color));
            color: white;
            padding: 15px 20px;
            border-radius: var(--radius);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 700;
        }
        
        .header-icons {
            display: flex;
            gap: 10px;
        }
        
        .icon-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .icon-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }
        
        /* Ù„ÙˆØ­Ø© Ø§Ù„Ø¨Ø­Ø« */
        .search-panel {
            background: white;
            padding: 15px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }
        
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .search-type {
            width: 120px;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            background: white;
        }
        
        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 16px;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
        }
        
        /* Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stats-panel {
            background: white;
            padding: 15px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            text-align: center;
        }
        
        .stats-number {
            font-size: 36px;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
        }
        
        /* Ù„ÙˆØ­Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ */
        .contacts-container {
            background: white;
            border-radius: var(--radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        .contacts-header {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .contacts-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .contact-item {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.3s ease;
            cursor: pointer;
        }
        
        .contact-item:hover {
            background: #f8f9fa;
        }
        
        .contact-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 5px;
            color: var(--dark-color);
        }
        
        .contact-phone {
            color: var(--text-light);
            font-size: 14px;
            direction: ltr;
            text-align: right;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
        .actions-panel {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .call-btn { background: var(--primary-color); }
        .sms-btn { background: var(--secondary-color); }
        .edit-btn { background: var(--accent-color); }
        .save-btn { background: #9C27B0; }
        .search-btn { background: #607D8B; }
        
        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø®ÙÙŠØ© */
        .hidden-menu {
            position: fixed;
            top: 80px;
            right: 20px;
            background: white;
            border-radius: var(--radius);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            padding: 10px;
            display: none;
            z-index: 1000;
            min-width: 180px;
        }
        
        .menu-item {
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.3s ease;
        }
        
        .menu-item:hover {
            background: #f5f5f5;
        }
        
        .menu-item i {
            width: 20px;
            text-align: center;
        }
        
        /* ØªØ¹Ø¯ÙŠÙ„ Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„ */
        .edit-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 16px;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #545b62;
        }
        
        .btn-success {
            background: var(--secondary-color);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ */
        .alert {
            padding: 15px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            display: none;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        /* ØªØ®ØµÙŠØµ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù„Ù„Ø£Ø±Ù‚Ø§Ù… */
        .phone-number {
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù„Ù„Ù‡ÙˆØ§ØªÙ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 20px;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            .search-type {
                width: 100%;
            }
            
            .actions-panel {
                gap: 10px;
            }
            
            .action-btn {
                width: 55px;
                height: 55px;
            }
            
            .stats-number {
                font-size: 28px;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .action-btn {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }
            
            .btn {
                padding: 10px 15px;
            }
        }
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„ØªÙØ§Ø¹Ù„ */
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(33, 150, 243, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(33, 150, 243, 0); }
            100% { box-shadow: 0 0 0 0 rgba(33, 150, 243, 0); }
        }
        
        /* Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
        <header class="header">
            <h1><i class="fas fa-phone-alt"></i> Ø¯Ù„ÙŠÙ„ Ù‡Ø§ØªÙÙŠ - Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</h1>
            <div class="header-icons">
                <button class="icon-btn" id="menuBtn" title="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
                    <i class="fas fa-ellipsis-v"></i>
                </button>
                <button class="icon-btn" id="syncBtn" title="Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¬Ù‡Ø§Øª">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button class="icon-btn" id="themeBtn" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¸Ù‡Ø±">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </header>
        
        <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ -->
        <div id="alertMessage" class="alert"></div>
        
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¨Ø­Ø« -->
        <div class="search-panel">
            <div class="search-box">
                <select class="search-type" id="searchType">
                    <option value="name">Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…</option>
                    <option value="phone">Ø¨Ø­Ø« Ø¨Ø§Ù„Ø±Ù‚Ù…</option>
                    <option value="all">Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙƒÙ„</option>
                </select>
                <input type="text" class="search-input" id="searchInput" placeholder="Ø§Ø¨Ø¯Ø£ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ù„Ø¨Ø­Ø«...">
                <button class="btn btn-primary" id="searchBtn">
                    <i class="fas fa-search"></i> Ø¨Ø­Ø«
                </button>
            </div>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn btn-secondary" id="showAllBtn">
                    <i class="fas fa-list"></i> Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„
                </button>
                <button class="btn btn-success" id="addContactBtn">
                    <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø©
                </button>
            </div>
        </div>
        
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
        <div class="stats-panel">
            <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</h3>
            <div class="stats-number" id="contactsCount">0</div>
            <p>Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ Ù…Ø³Ø¬Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</p>
        </div>
        
        <!-- Ù„ÙˆØ­Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ -->
        <div class="contacts-container">
            <div class="contacts-header">
                <h3><i class="fas fa-users"></i> Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</h3>
                <div>
                    <button class="btn btn-secondary" id="exportBtn" style="margin-left: 10px;">
                        <i class="fas fa-file-export"></i> ØªØµØ¯ÙŠØ±
                    </button>
                    <button class="btn btn-secondary" id="importBtn">
                        <i class="fas fa-file-import"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯
                    </button>
                </div>
            </div>
            
            <div class="contacts-list" id="contactsList">
                <!-- Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø³ØªØ­Ù…Ù„ Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>
        
        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->
        <div class="actions-panel">
            <button class="action-btn call-btn" id="callBtn" title="Ø§ØªØµØ§Ù„">
                <i class="fas fa-phone"></i>
            </button>
            <button class="action-btn sms-btn" id="smsBtn" title="Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ©">
                <i class="fas fa-comment-alt"></i>
            </button>
            <button class="action-btn edit-btn" id="editBtn" title="ØªØ¹Ø¯ÙŠÙ„">
                <i class="fas fa-edit"></i>
            </button>
            <button class="action-btn save-btn" id="saveBtn" title="Ø­ÙØ¸" style="display: none;">
                <i class="fas fa-save"></i>
            </button>
            <button class="action-btn search-btn" id="advancedSearchBtn" title="Ø¨Ø­Ø« Ù…ØªÙ‚Ø¯Ù…">
                <i class="fas fa-search-plus"></i>
            </button>
        </div>
        
        <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®ÙÙŠØ© -->
        <div class="hidden-menu" id="hiddenMenu">
            <div class="menu-item" id="menuImport">
                <i class="fas fa-file-import"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Ù…Ù„Ù
            </div>
            <div class="menu-item" id="menuExport">
                <i class="fas fa-file-export"></i> ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Ù…Ù„Ù
            </div>
            <div class="menu-item" id="menuSync">
                <i class="fas fa-sync-alt"></i> Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¬Ù‡Ø§Øª
            </div>
            <div class="menu-item" id="menuUpdate">
                <i class="fas fa-redo"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            </div>
            <div class="menu-item" id="menuSettings">
                <i class="fas fa-cog"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            </div>
            <div class="menu-item" id="menuHelp">
                <i class="fas fa-question-circle"></i> Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
            </div>
        </div>
        
        <!-- Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„/Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ -->
        <div class="edit-modal" id="editModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ Ø¬Ø¯ÙŠØ¯Ø©</h3>
                    <button class="icon-btn" id="closeModalBtn" style="background: #f8f9fa; color: #666;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <form id="contactForm">
                    <input type="hidden" id="contactId">
                    
                    <div class="form-group">
                        <label class="form-label" for="contactName">
                            <i class="fas fa-user"></i> Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø© *
                        </label>
                        <input type="text" class="form-control" id="contactName" 
                               placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="contactPhone">
                            <i class="fas fa-phone"></i> Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *
                        </label>
                        <input type="tel" class="form-control phone-number" id="contactPhone" 
                               placeholder="Ù…Ø«Ø§Ù„: 0591234567 Ø£Ùˆ Ù Ù¥Ù©Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="contactEmail">
                            <i class="fas fa-envelope"></i> Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                        </label>
                        <input type="email" class="form-control" id="contactEmail" 
                               placeholder="example@email.com">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="contactGroup">
                            <i class="fas fa-tag"></i> Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
                        </label>
                        <select class="form-control" id="contactGroup">
                            <option value="">Ø§Ø®ØªØ± Ù…Ø¬Ù…ÙˆØ¹Ø©</option>
                            <option value="Ø¹Ø§Ø¦Ù„Ø©">Ø¹Ø§Ø¦Ù„Ø©</option>
                            <option value="Ø£ØµØ¯Ù‚Ø§Ø¡">Ø£ØµØ¯Ù‚Ø§Ø¡</option>
                            <option value="Ø¹Ù…Ù„">Ø¹Ù…Ù„</option>
                            <option value="Ø·ÙˆØ§Ø±Ø¦">Ø·ÙˆØ§Ø±Ø¦</option>
                            <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="contactNotes">
                            <i class="fas fa-sticky-note"></i> Ù…Ù„Ø§Ø­Ø¸Ø§Øª
                        </label>
                        <textarea class="form-control" id="contactNotes" 
                                  rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea>
                    </div>
                    
                    <div class="button-group">
                        <button type="submit" class="btn btn-primary" id="saveContactBtn">
                            <i class="fas fa-save"></i> Ø­ÙØ¸
                        </button>
                        <button type="button" class="btn btn-secondary" id="cancelBtn">
                            <i class="fas fa-times"></i> Ø¥Ù„ØºØ§Ø¡
                        </button>
                        <button type="button" class="btn btn-danger" id="deleteBtn" style="display: none;">
                            <i class="fas fa-trash"></i> Ø­Ø°Ù
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Ù†Ø§ÙØ°Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯ -->
        <div class="edit-modal" id="importModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</h3>
                    <button class="icon-btn close-import">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-file-upload"></i> Ø§Ø®ØªØ± Ù…Ù„Ù Ù„Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
                    </label>
                    <input type="file" class="form-control" id="importFile" 
                           accept=".txt,.csv,.json,.vcf,.xlsx,.db">
                    <small style="display: block; margin-top: 5px; color: #666;">
                        ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ù„ÙØ§Øª: TXT, CSV, JSON, VCF, Excel, SQLite
                    </small>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-cogs"></i> Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
                    </label>
                    <div>
                        <label style="display: block; margin-bottom: 5px;">
                            <input type="checkbox" id="skipDuplicates" checked>
                            ØªØ®Ø·ÙŠ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ÙƒØ±Ø±Ø©
                        </label>
                        <label style="display: block; margin-bottom: 5px;">
                            <input type="checkbox" id="updateExisting">
                            ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" id="startImportBtn">
                        <i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
                    </button>
                    <button type="button" class="btn btn-secondary close-import">
                        <i class="fas fa-times"></i> Ø¥Ù„ØºØ§Ø¡
                    </button>
                </div>
                
                <div id="importProgress" style="margin-top: 20px; display: none;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯...</span>
                        <span id="importStatus">0%</span>
                    </div>
                    <div style="height: 10px; background: #f0f0f0; border-radius: 5px; overflow: hidden;">
                        <div id="importProgressBar" style="height: 100%; background: var(--primary-color); width: 0%;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script>
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
        let contacts = JSON.parse(localStorage.getItem('phonebook_contacts')) || [
            { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', phone: '0591234567', email: 'ahmed@example.com', group: 'Ø£ØµØ¯Ù‚Ø§Ø¡', notes: '' },
            { id: 2, name: 'Ø³Ø§Ø±Ø© Ø®Ø§Ù„Ø¯', phone: '0569876543', email: 'sara@example.com', group: 'Ø¹Ø§Ø¦Ù„Ø©', notes: 'Ø§Ø¨Ù†Ø© Ø§Ù„Ø¹Ù…' },
            { id: 3, name: 'Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ', phone: '0501122334', email: '', group: 'Ø¹Ù…Ù„', notes: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹' },
            { id: 4, name: 'ÙØ§Ø·Ù…Ø© Ø­Ø³Ù†', phone: 'Ù Ù¥Ù¨Ù§Ù¦Ù¥Ù¤Ù£Ù¢Ù¡', email: 'fatima@example.com', group: '', notes: '' },
            { id: 5, name: 'Ø®Ø§Ù„Ø¯ Ø£Ø­Ù…Ø¯', phone: '+970592345678', email: 'khaled@company.com', group: 'Ø¹Ù…Ù„', notes: 'Ø´Ø±ÙŠÙƒ Ø§Ù„Ø¹Ù…Ù„' }
        ];
        
        let selectedContact = null;
        let editMode = false;
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            loadContacts();
            updateContactsCount();
            setupEventListeners();
        });
        
        function initApp() {
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ù† LocalStorage
            const theme = localStorage.getItem('phonebook_theme') || 'light';
            setTheme(theme);
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ù‡Ø§Øª
            updateContactsCount();
        }
        
        function setTheme(theme) {
            const themeBtn = document.getElementById('themeBtn');
            const icon = themeBtn.querySelector('i');
            
            if (theme === 'dark') {
                document.body.style.background = 'linear-gradient(135deg, #2c3e50 0%, #1a1a2e 100%)';
                document.body.style.color = '#f8f9fa';
                icon.className = 'fas fa-sun';
                themeBtn.title = 'ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­';
            } else {
                document.body.style.background = 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)';
                document.body.style.color = '#333';
                icon.className = 'fas fa-moon';
                themeBtn.title = 'ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†';
            }
            
            localStorage.setItem('phonebook_theme', theme);
        }
        
        function loadContacts(searchQuery = '', searchType = 'all') {
            const contactsList = document.getElementById('contactsList');
            let filteredContacts = [...contacts];
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ query
            if (searchQuery.trim()) {
                const query = normalizeSearchQuery(searchQuery);
                filteredContacts = contacts.filter(contact => {
                    const name = normalizeArabic(contact.name);
                    const phone = normalizePhoneNumber(contact.phone);
                    
                    if (searchType === 'name') {
                        return name.includes(query);
                    } else if (searchType === 'phone') {
                        return phone.includes(query);
                    } else {
                        return name.includes(query) || phone.includes(query);
                    }
                });
            }
            
            // Ø¹Ø±Ø¶ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
            if (filteredContacts.length === 0) {
                contactsList.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: #666;">
                        <i class="fas fa-user-slash" style="font-size: 48px; margin-bottom: 15px;"></i>
                        <h4>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¬Ù‡Ø§Øª Ø§ØªØµØ§Ù„</h4>
                        <p>${searchQuery ? 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬' : 'Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ù„Ø¨Ø¯Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù‡Ø§Øª Ø§ØªØµØ§Ù„'}</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            filteredContacts.forEach(contact => {
                const phoneFormatted = formatPhoneNumber(contact.phone);
                html += `
                    <div class="contact-item" data-id="${contact.id}" onclick="selectContact(${contact.id})">
                        <div class="contact-name">${contact.name}</div>
                        <div class="contact-phone">${phoneFormatted}</div>
                        ${contact.group ? `<small style="color: var(--primary-color);">${contact.group}</small>` : ''}
                    </div>
                `;
            });
            
            contactsList.innerHTML = html;
            
            // ØªØ­Ø¯ÙŠØ¯ Ø£ÙˆÙ„ Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            if (filteredContacts.length > 0 && !selectedContact) {
                selectContact(filteredContacts[0].id);
            }
        }
        
        function selectContact(id) {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚
            document.querySelectorAll('.contact-item').forEach(item => {
                item.style.background = '';
            });
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            const contactItem = document.querySelector(`.contact-item[data-id="${id}"]`);
            if (contactItem) {
                contactItem.style.background = '#f0f7ff';
            }
            
            // Ø­ÙØ¸ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
            selectedContact = contacts.find(c => c.id == id);
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
            updateActionButtons();
        }
        
        function updateActionButtons() {
            const callBtn = document.getElementById('callBtn');
            const smsBtn = document.getElementById('smsBtn');
            const editBtn = document.getElementById('editBtn');
            
            if (selectedContact) {
                callBtn.disabled = false;
                smsBtn.disabled = false;
                editBtn.disabled = false;
                
                // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶ Ù„Ø²Ø± Ø§Ù„Ø§ØªØµØ§Ù„
                callBtn.classList.add('pulse');
            } else {
                callBtn.disabled = true;
                smsBtn.disabled = true;
                editBtn.disabled = true;
                callBtn.classList.remove('pulse');
            }
        }
        
        function updateContactsCount() {
            document.getElementById('contactsCount').textContent = contacts.length;
        }
        
        // Ø¯Ø¹Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
        function normalizeArabic(text) {
            if (!text) return '';
            return text
                .replace(/Ø£|Ø¥|Ø¢/g, 'Ø§')
                .replace(/Ø©/g, 'Ù‡')
                .replace(/Ù‰/g, 'ÙŠ')
                .replace(/[^\u0621-\u064A0-9]/g, '')
                .toLowerCase();
        }
        
        function normalizePhoneNumber(phone) {
            if (!phone) return '';
            return phone
                .replace(/[\s\-+()]/g, '')
                .replace(/Ù /g, '0').replace(/Ù¡/g, '1').replace(/Ù¢/g, '2')
                .replace(/Ù£/g, '3').replace(/Ù¤/g, '4').replace(/Ù¥/g, '5')
                .replace(/Ù¦/g, '6').replace(/Ù§/g, '7').replace(/Ù¨/g, '8')
                .replace(/Ù©/g, '9')
                .replace(/Û°/g, '0').replace(/Û±/g, '1').replace(/Û²/g, '2')
                .replace(/Û³/g, '3').replace(/Û´/g, '4').replace(/Ûµ/g, '5')
                .replace(/Û¶/g, '6').replace(/Û·/g, '7').replace(/Û¸/g, '8')
                .replace(/Û¹/g, '9');
        }
        
        function normalizeSearchQuery(query) {
            return normalizeArabic(normalizePhoneNumber(query));
        }
        
        function formatPhoneNumber(phone) {
            const normalized = normalizePhoneNumber(phone);
            if (normalized.length === 10) {
                return `${normalized.substring(0, 3)}-${normalized.substring(3, 6)}-${normalized.substring(6)}`;
            }
            return normalized;
        }
        
        function showAlert(message, type = 'success') {
            const alertDiv = document.getElementById('alertMessage');
            alertDiv.textContent = message;
            alertDiv.className = `alert alert-${type}`;
            alertDiv.style.display = 'block';
            
            setTimeout(() => {
                alertDiv.style.display = 'none';
            }, 3000);
        }
        
        function setupEventListeners() {
            // Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            document.getElementById('menuBtn').addEventListener('click', function(e) {
                e.stopPropagation();
                const menu = document.getElementById('hiddenMenu');
                menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            document.addEventListener('click', function() {
                document.getElementById('hiddenMenu').style.display = 'none';
            });
            
            // Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¸Ù‡Ø±
            document.getElementById('themeBtn').addEventListener('click', function() {
                const currentTheme = localStorage.getItem('phonebook_theme') || 'light';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                setTheme(newTheme);
            });
            
            // Ø²Ø± Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©
            document.getElementById('syncBtn').addEventListener('click', function() {
                showAlert('Ø¬Ø§Ø±ÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„...', 'success');
                // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¯ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©
                setTimeout(() => {
                    showAlert('ØªÙ…Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                }, 1000);
            });
            
            // Ø²Ø± Ø§Ù„Ø¨Ø­Ø«
            document.getElementById('searchBtn').addEventListener('click', function() {
                const query = document.getElementById('searchInput').value;
                const type = document.getElementById('searchType').value;
                loadContacts(query, type);
            });
            
            // Ø§Ù„Ø¨Ø­Ø« Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨Ø©
            document.getElementById('searchInput').addEventListener('input', function() {
                const query = this.value;
                const type = document.getElementById('searchType').value;
                if (query.length === 0 || query.length > 2) {
                    loadContacts(query, type);
                }
            });
            
            // Ø²Ø± Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„
            document.getElementById('showAllBtn').addEventListener('click', function() {
                document.getElementById('searchInput').value = '';
                loadContacts();
            });
            
            // Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø©
            document.getElementById('addContactBtn').addEventListener('click', function() {
                openEditModal();
            });
            
            // Ø²Ø± Ø§Ù„Ø§ØªØµØ§Ù„
            document.getElementById('callBtn').addEventListener('click', function() {
                if (selectedContact) {
                    const phone = normalizePhoneNumber(selectedContact.phone);
                    if (phone) {
                        // ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ØŒ Ù†Ø³ØªØ®Ø¯Ù… tel: link
                        window.location.href = `tel:${phone}`;
                        showAlert(`Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ ${selectedContact.name}...`, 'success');
                    }
                }
            });
            
            // Ø²Ø± Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            document.getElementById('smsBtn').addEventListener('click', function() {
                if (selectedContact) {
                    const phone = normalizePhoneNumber(selectedContact.phone);
                    if (phone) {
                        window.location.href = `sms:${phone}`;
                    }
                }
            });
            
            // Ø²Ø± Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
            document.getElementById('editBtn').addEventListener('click', function() {
                if (selectedContact) {
                    openEditModal(selectedContact);
                }
            });
            
            // Ø²Ø± Ø­ÙØ¸
            document.getElementById('saveBtn').addEventListener('click', function() {
                if (editMode) {
                    saveAllEdits();
                }
            });
            
            // Ø²Ø± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
            document.getElementById('advancedSearchBtn').addEventListener('click', function() {
                document.getElementById('searchInput').focus();
                showAlert('Ø§ÙƒØªØ¨ Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… ÙÙŠ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ÙˆØ§Ù„Ø£Ø±Ù‚Ø§Ù…', 'success');
            });
            
            // Ø²Ø± Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
            document.getElementById('importBtn').addEventListener('click', function() {
                document.getElementById('importModal').style.display = 'flex';
            });
            
            // Ø²Ø± Ø§Ù„ØªØµØ¯ÙŠØ±
            document.getElementById('exportBtn').addEventListener('click', exportContacts);
            
            // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
            document.getElementById('closeModalBtn').addEventListener('click', closeEditModal);
            document.getElementById('cancelBtn').addEventListener('click', closeEditModal);
            
            // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
            document.querySelectorAll('.close-import').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('importModal').style.display = 'none';
                });
            });
            
            // Ø­ÙØ¸ Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„
            document.getElementById('contactForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveContact();
            });
            
            // Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
            document.getElementById('startImportBtn').addEventListener('click', startImport);
            
            // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®ÙÙŠØ©
            document.getElementById('menuImport').addEventListener('click', function() {
                document.getElementById('importModal').style.display = 'flex';
                document.getElementById('hiddenMenu').style.display = 'none';
            });
            
            document.getElementById('menuExport').addEventListener('click', function() {
                exportContacts();
                document.getElementById('hiddenMenu').style.display = 'none';
            });
            
            document.getElementById('menuSync').addEventListener('click', function() {
                syncContacts();
                document.getElementById('hiddenMenu').style.display = 'none';
            });
            
            document.getElementById('menuUpdate').addEventListener('click', function() {
                updateContacts();
                document.getElementById('hiddenMenu').style.display = 'none';
            });
            
            document.getElementById('menuSettings').addEventListener('click', function() {
                showAlert('Ù‚Ø±ÙŠØ¨Ø§Ù‹: ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'success');
                document.getElementById('hiddenMenu').style.display = 'none';
            });
            
            document.getElementById('menuHelp').addEventListener('click', function() {
                showHelp();
                document.getElementById('hiddenMenu').style.display = 'none';
            });
        }
        
        function openEditModal(contact = null) {
            const modal = document.getElementById('editModal');
            const form = document.getElementById('contactForm');
            const deleteBtn = document.getElementById('deleteBtn');
            
            if (contact) {
                // ÙˆØ¶Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
                document.getElementById('modalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„';
                document.getElementById('contactId').value = contact.id;
                document.getElementById('contactName').value = contact.name;
                document.getElementById('contactPhone').value = contact.phone;
                document.getElementById('contactEmail').value = contact.email || '';
                document.getElementById('contactGroup').value = contact.group || '';
                document.getElementById('contactNotes').value = contact.notes || '';
                deleteBtn.style.display = 'inline-block';
                
                // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ù„Ù„Ø­Ø°Ù
                deleteBtn.onclick = function() {
                    if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ${contact.name}ØŸ`)) {
                        deleteContact(contact.id);
                        closeEditModal();
                    }
                };
            } else {
                // ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
                document.getElementById('modalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ Ø¬Ø¯ÙŠØ¯Ø©';
                form.reset();
                document.getElementById('contactId').value = '';
                deleteBtn.style.display = 'none';
            }
            
            modal.style.display = 'flex';
        }
        
        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
        }
        
        function saveContact() {
            const id = document.getElementById('contactId').value;
            const name = document.getElementById('contactName').value.trim();
            const phone = document.getElementById('contactPhone').value.trim();
            const email = document.getElementById('contactEmail').value.trim();
            const group = document.getElementById('contactGroup').value;
            const notes = document.getElementById('contactNotes').value.trim();
            
            if (!name || !phone) {
                showAlert('Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ø·Ù„ÙˆØ¨Ø§Ù†', 'error');
                return;
            }
            
            if (id) {
                // ØªØ­Ø¯ÙŠØ« Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ Ù…ÙˆØ¬ÙˆØ¯Ø©
                const index = contacts.findIndex(c => c.id == id);
                if (index !== -1) {
                    contacts[index] = { ...contacts[index], name, phone, email, group, notes };
                    showAlert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                }
            } else {
                // Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ Ø¬Ø¯ÙŠØ¯Ø©
                const newId = contacts.length > 0 ? Math.max(...contacts.map(c => c.id)) + 1 : 1;
                contacts.push({ id: newId, name, phone, email, group, notes });
                showAlert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
            
            // Ø­ÙØ¸ ÙÙŠ LocalStorage
            localStorage.setItem('phonebook_contacts', JSON.stringify(contacts));
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            loadContacts();
            updateContactsCount();
            closeEditModal();
        }
        
        function deleteContact(id) {
            const index = contacts.findIndex(c => c.id == id);
            if (index !== -1) {
                const contactName = contacts[index].name;
                contacts.splice(index, 1);
                
                // Ø­ÙØ¸ ÙÙŠ LocalStorage
                localStorage.setItem('phonebook_contacts', JSON.stringify(contacts));
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                loadContacts();
                updateContactsCount();
                selectedContact = null;
                updateActionButtons();
                
                showAlert(`ØªÙ… Ø­Ø°Ù ${contactName}`, 'success');
            }
        }
        
        function exportContacts() {
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù CSV
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Ø§Ù„Ø§Ø³Ù…,Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ,Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ,Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©,Ù…Ù„Ø§Ø­Ø¸Ø§Øª\n";
            
            contacts.forEach(contact => {
                const row = [
                    `"${contact.name}"`,
                    `"${contact.phone}"`,
                    `"${contact.email || ''}"`,
                    `"${contact.group || ''}"`,
                    `"${contact.notes || ''}"`
                ].join(',');
                csvContent += row + "\n";
            });
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `Ø¯Ù„ÙŠÙ„_Ù‡Ø§ØªÙÙŠ_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showAlert('ØªÙ… ØªØµØ¯ÙŠØ± Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        function startImport() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showAlert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ù„Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯', 'error');
                return;
            }
            
            const skipDuplicates = document.getElementById('skipDuplicates').checked;
            const updateExisting = document.getElementById('updateExisting').checked;
            
            // Ø¹Ø±Ø¶ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            const progressDiv = document.getElementById('importProgress');
            const progressBar = document.getElementById('importProgressBar');
            const statusText = document.getElementById('importStatus');
            progressDiv.style.display = 'block';
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const content = e.target.result;
                    let importedContacts = [];
                    
                    // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù„ÙŠÙ„ JSON
                    try {
                        const jsonData = JSON.parse(content);
                        if (Array.isArray(jsonData)) {
                            importedContacts = jsonData;
                        }
                    } catch (e) {
                        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† JSONØŒ Ø¬Ø±Ø¨ ØªØ­Ù„ÙŠÙ„ CSV
                        const lines = content.split('\n');
                        if (lines.length > 1) {
                            // ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø£ÙˆÙ„ (Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†)
                            for (let i = 1; i < lines.length; i++) {
                                const line = lines[i].trim();
                                if (line) {
                                    const parts = line.split(',');
                                    if (parts.length >= 2) {
                                        const name = parts[0].replace(/"/g, '').trim();
                                        const phone = parts[1].replace(/"/g, '').trim();
                                        const email = parts[2] ? parts[2].replace(/"/g, '').trim() : '';
                                        const group = parts[3] ? parts[3].replace(/"/g, '').trim() : '';
                                        const notes = parts[4] ? parts[4].replace(/"/g, '').trim() : '';
                                        
                                        importedContacts.push({ name, phone, email, group, notes });
                                    }
                                }
                            }
                        }
                    }
                    
                    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
                    let added = 0;
                    let updated = 0;
                    let skipped = 0;
                    
                    importedContacts.forEach((imported, index) => {
                        // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
                        const progress = ((index + 1) / importedContacts.length) * 100;
                        progressBar.style.width = `${progress}%`;
                        statusText.textContent = `${Math.round(progress)}%`;
                        
                        const existingIndex = contacts.findIndex(c => 
                            normalizePhoneNumber(c.phone) === normalizePhoneNumber(imported.phone)
                        );
                        
                        if (existingIndex !== -1) {
                            if (updateExisting) {
                                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
                                contacts[existingIndex] = {
                                    ...contacts[existingIndex],
                                    ...imported,
                                    id: contacts[existingIndex].id
                                };
                                updated++;
                            } else if (!skipDuplicates) {
                                // Ø¥Ø¶Ø§ÙØ© ÙƒÙ…ÙƒØ±Ø±
                                const newId = Math.max(...contacts.map(c => c.id)) + 1;
                                contacts.push({ ...imported, id: newId });
                                added++;
                            } else {
                                skipped++;
                            }
                        } else {
                            // Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø¬Ø¯ÙŠØ¯Ø©
                            const newId = contacts.length > 0 ? Math.max(...contacts.map(c => c.id)) + 1 : 1;
                            contacts.push({ ...imported, id: newId });
                            added++;
                        }
                    });
                    
                    // Ø­ÙØ¸ ÙÙŠ LocalStorage
                    localStorage.setItem('phonebook_contacts', JSON.stringify(contacts));
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                    setTimeout(() => {
                        progressDiv.style.display = 'none';
                        document.getElementById('importModal').style.display = 'none';
                        
                        showAlert(
                            `ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­: ${added} Ù…Ø¶Ø§ÙØ©ØŒ ${updated} Ù…Ø­Ø¯Ø«Ø©ØŒ ${skipped} Ù…ÙƒØ±Ø±Ø©`,
                            'success'
                        );
                        
                        loadContacts();
                        updateContactsCount();
                        fileInput.value = '';
                    }, 500);
                    
                } catch (error) {
                    progressDiv.style.display = 'none';
                    showAlert(`Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù: ${error.message}`, 'error');
                }
            };
            
            reader.readAsText(file);
        }
        
        function syncContacts() {
            showAlert('Ø¬Ø§Ø±ÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„...', 'success');
            // ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù‡Ù†Ø§ Ø³ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© Ù…Ø²Ø§Ù…Ù†Ø©
            setTimeout(() => {
                showAlert('ØªÙ…Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }, 1500);
        }
        
        function updateContacts() {
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ù‡Ø§Øª
            loadContacts();
            updateContactsCount();
            showAlert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„', 'success');
        }
        
        function showHelp() {
            const helpMessage = `
                <h3>Ø¯Ù„ÙŠÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:</h3>
                <ol style="text-align: right; padding-right: 20px;">
                    <li><strong>Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„:</strong> Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± + ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¨Ø­Ø«</li>
                    <li><strong>Ø§Ù„Ø¨Ø­Ø«:</strong> Ø§ÙƒØªØ¨ ÙÙŠ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« Ù„Ù„Ø¨Ø­Ø« Ø§Ù„ÙÙˆØ±ÙŠ</li>
                    <li><strong>Ø§Ù„Ø§ØªØµØ§Ù„:</strong> Ø­Ø¯Ø¯ Ø¬Ù‡Ø© Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± ğŸ“</li>
                    <li><strong>Ø§Ù„Ø±Ø³Ø§Ø¦Ù„:</strong> Ø­Ø¯Ø¯ Ø¬Ù‡Ø© Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± âœ‰ï¸</li>
                    <li><strong>Ø§Ù„ØªØ¹Ø¯ÙŠÙ„:</strong> Ø­Ø¯Ø¯ Ø¬Ù‡Ø© Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± âœï¸</li>
                    <li><strong>Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯:</strong> Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®ÙÙŠØ© â† Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Ù…Ù„Ù</li>
                    <li><strong>Ø§Ù„ØªØµØ¯ÙŠØ±:</strong> Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± ØªØµØ¯ÙŠØ± Ù„Ø­ÙØ¸ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</li>
                </ol>
                <p><strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</p>
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
            const helpModal = document.createElement('div');
            helpModal.className = 'edit-modal';
            helpModal.style.display = 'flex';
            helpModal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3><i class="fas fa-question-circle"></i> Ù…Ø³Ø§Ø¹Ø¯Ø© - Ø¯Ù„ÙŠÙ„ Ù‡Ø§ØªÙÙŠ</h3>
                        <button class="icon-btn close-help">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div style="padding: 20px; max-height: 400px; overflow-y: auto;">
                        ${helpMessage}
                    </div>
                    <div class="button-group" style="justify-content: center;">
                        <button class="btn btn-primary close-help">
                            <i class="fas fa-check"></i> ÙÙ‡Ù…Øª
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(helpModal);
            
            // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø¥ØºÙ„Ø§Ù‚
            helpModal.querySelectorAll('.close-help').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.body.removeChild(helpModal);
                });
            });
        }
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø¨Ø§Ù„Ø²Ø± Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeEditModal();
                document.getElementById('importModal').style.display = 'none';
                document.getElementById('hiddenMenu').style.display = 'none';
            }
        });
        
        // Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù… Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬
        document.addEventListener('dblclick', function(e) {
            if (e.target.closest('.contact-phone')) {
                const phoneText = e.target.textContent;
                const phoneNumber = normalizePhoneNumber(phoneText);
                
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(phoneNumber).then(() => {
                        showAlert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù… Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'success');
                    });
                }
            }
        });
    </script>
</body>
</html>